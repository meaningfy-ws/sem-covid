# *WP2.2 - Trained classification models on PWDB*

## **Dependencies**

- pycaret
- mlflow 

## **Classifiers**

The classifiers were trained based on the textual fields from ds_pwdb dataset. A classifier has been trained for each field of the ds_pwdb dataset in the list below. :
 - businesses 
 - citizens
 - workers
 - category
 - subcategory
 - type_of_measure 
 - funding

Each trained classifier is stored in a separate archive, where archive called pwdb_XXXX, where XXXX is the name under which the field was trained classifier (ex. pwdb_businesses).

### **Source code**
A separate pipeline has been developed for the feature engineering and model training process, each pipeline is made through a class:
 - FeatureEngineering - base class for a feature engineering pipeline .
 - FeatureEngineeringBERT - class for a BERT-based feature engineering pipeline.
 - ModelTraining - base class for a training model pipeline .

 [Source code](sem_covid/services/ml_pipelines/pwdb_classifiers_pipeline.py)
 - sem_covid/services/ml_pipelines/pwdb_classifiers_pipeline.py

 [Execution in Jupyter Notebook](sem_covid/entrypoints/notebooks/classification_pipeline.ipynb)
 - sem_covid/entrypoints/notebooks/classification_pipeline.ipynb

### **The archive structure of a trained model**
Each archive of a trained model has the following structure:
- ***conda.yaml*** - dependency configuration
- ***Holdout.html*** - file containing the name of the chosen model and its metrics obtained based on the training set
- ***MLmodel*** - metadata generated by mlflow for the model
- ***model.pkl*** - the trained model stored in the pickle format 
- ***Results.html*** - file with model metrics on the test set
## **Results**
 The following results are obtained for each classifier :
 
 - | The categorical field  | Accuracy | F1-score | Model name |
 - | businesses | 0.71 |  0.64 | Ridge Classifier |
 - | citizens | 0.92 | 0.26 | Light Gradient Boosting Machine |
 - | workers | 0.77 | 0.74 | Ridge Classifier |
 - | category | 0.66 | 0.63 | Light Gradient Boosting Machine |
 - | subcategory | 0.73 | 0.69 | Linear Discriminant Analysis |
 - | type_of_measure | 0.78 | 0.75 | Light Gradient Boosting Machine | 
 - | funding | 0.61 | 0.55 | Light Gradient Boosting Machine |
